{"type":"data","nodes":[null,{"type":"data","data":[{"post":1},{"metadata":2,"content":7},{"icon":3,"title":4,"date":5,"excerpt":6},"🔮","Reverse Engineering a Unity Game",["Date","2022-06-05T00:00:00.000Z"],"How I found the boss claw patrol logic in Boneworks and built a mod to change it.","\u003Cp>I've always wondered how people mod games -- figuring out all the APIs, what they do and hooking into them to make something cool. I recently went through this process of understanding the exact logic used in a part of the game and building a mod to change it. During this I learnt how C# and Unity compile to machine code, how to read disassembled x86 code and the various tools to help with these tasks. But before I get to that, I'll explain what I'm modding and why.\u003C/p>\n\u003Cul>\n\u003Cli>\n\u003Ca href=\"#introduction\" onclick=\"event.stopPropagation()\">🎙️ Introduction\u003C/a>\n\u003C/li>\n\u003Cli>\n\u003Ca href=\"#technical-background\" onclick=\"event.stopPropagation()\">⚙️ Technical background\u003C/a>\n\u003Cul>\n\u003Cli>\n\u003Ca href=\"#how-the-game-is-compiled\" onclick=\"event.stopPropagation()\">🏗️ How the game is compiled\u003C/a>\n\u003C/li>\n\u003Cli>\n\u003Ca href=\"#c-decompilers\" onclick=\"event.stopPropagation()\">🪛 C# decompilers\u003C/a>\n\u003C/li>\n\u003Cli>\n\u003Ca href=\"#il2cpp-reversers\" onclick=\"event.stopPropagation()\">🪄 IL2CPP reversers\u003C/a>\n\u003C/li>\n\u003Cli>\n\u003Ca href=\"#x86-disassemblers\" onclick=\"event.stopPropagation()\">🤖 x86 disassemblers\u003C/a>\n\u003C/li>\n\u003Cli>\n\u003Ca href=\"#inspecting-a-running-game\" onclick=\"event.stopPropagation()\">⏯️ Inspecting a running game\u003C/a>\n\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003Cli>\n\u003Ca href=\"#reverse-engineering-the-boss-claw\" onclick=\"event.stopPropagation()\">🗜️ Reverse engineering the boss claw\u003C/a>\n\u003Cul>\n\u003Cli>\n\u003Ca href=\"#building-the-mod\" onclick=\"event.stopPropagation()\">🧑‍💻 Building the mod\u003C/a>\n\u003Cul>\n\u003Cli>\n\u003Ca href=\"#links\" onclick=\"event.stopPropagation()\">Links\u003C/a>\n\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003Cli>\n\u003Ca href=\"#decompiling-the-code\" onclick=\"event.stopPropagation()\">🔍 Decompiling the code\u003C/a>\n\u003C/li>\n\u003Cli>\n\u003Ca href=\"#disassembling-the-code\" onclick=\"event.stopPropagation()\">🔬 Disassembling the code\u003C/a>\n\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003Cli>\n\u003Ca href=\"#conclusion\" onclick=\"event.stopPropagation()\">📃 Conclusion\u003C/a>\n\u003C/li>\n\u003C/ul>\n\u003Ch2 id=\"introduction\">\u003Ca href=\"#introduction\" role=\"img\" aria-label=\"Link to heading\" onclick=\"event.stopPropagation()\">\u003C/a>🎙️ Introduction\u003C/h2>\n\u003Cp>\u003Ca href=\"https://store.steampowered.com/app/823500/BONEWORKS/\" onclick=\"event.stopPropagation()\">Boneworks\u003C/a> is amazing! 😍 If you're wondering why it's so great \u003Ca href=\"https://www.youtube.com/watch?v=7irWC2uXuSY\" onclick=\"event.stopPropagation()\">this video\u003C/a> sums it up nicely. I bought it when I first got my VR headset a year ago but my first playthrough was a nauseating experience as I managed to get my body stuck in the monkey bars of the museum. 🤢 I never even saw an enemy before putting it down and getting into other games like Beat Saber. But about a month ago I picked it back up and to my surprise I no longer got motion sick! I played through the whole story and the side chambers and loved it so much that I decided to keep playing it and turn to one of my favourite pastimes: speedrunning. 🏃 I mostly enjoy watching speedruns and letting other people put in the hundreds of hours of grinding and glitch hunting, so two weeks in and \u003Ca href=\"https://www.youtube.com/watch?v=fWU1n0-W-wA\" onclick=\"event.stopPropagation()\">with a respectable time\u003C/a> that would have placed in the top 20 on the leaderboard if I'd submitted it, this was probably the furthest I'd ever gone into running a game myself. At this point, to get better times I needed to practise tricks like \u003Ca href=\"https://youtu.be/1nZAoV9Tna8?t=167\" onclick=\"event.stopPropagation()\">flinging from the boss claw to the finish of Streets\u003C/a> so I could pull them off consistently. The problem with this is that the direction the boss claw travels is totally random, so it is annoying to practise when it rarely goes the right way for a fling. 😩 That's when I set out to fix this. I decided to build a mod to force it in the right direction and also see if I could reverse engineer the logic used to decide where the boss claw will go, just in case there's a way to influence it to go in the desired direction without mods.\u003C/p>\n\u003Ch2 id=\"technical-background\">\u003Ca href=\"#technical-background\" role=\"img\" aria-label=\"Link to heading\" onclick=\"event.stopPropagation()\">\u003C/a>⚙️ Technical background\u003C/h2>\n\u003Cp>This section will be pretty dense so I'll include a \u003Cstrong>tl;dr\u003C/strong> in a quote block under each heading.\u003C/p>\n\u003Ch3 id=\"how-the-game-is-compiled\">\u003Ca href=\"#how-the-game-is-compiled\" role=\"img\" aria-label=\"Link to heading\" onclick=\"event.stopPropagation()\">\u003C/a>🏗️ How the game is compiled\u003C/h3>\n\u003Cblockquote>\n\u003Cp>C# source code -> compiled to C# IL -> compiled to C++ code by IL2CPP -> compiled to x86 binary.\u003C/p>\n\u003C/blockquote>\n\u003Cp>Boneworks is a \u003Ca href=\"https://unity.com/\" onclick=\"event.stopPropagation()\">Unity\u003C/a> game, and as such the code is written in \u003Ca href=\"https://en.wikipedia.org/wiki/C_Sharp_(programming_language)\" onclick=\"event.stopPropagation()\">C#\u003C/a>. A lot of languages (eg. \u003Ca href=\"https://en.wikipedia.org/wiki/C%2B%2B\" onclick=\"event.stopPropagation()\">C++\u003C/a>) compile into instructions for a particular CPU architecture (eg. \u003Ca href=\"https://en.wikipedia.org/wiki/X86\" onclick=\"event.stopPropagation()\">x86\u003C/a> which is most popular for PCs today), but C# compiles to an intermediate language (IL) which no CPU understands. Instead an execution engine (eg. \u003Ca href=\"https://en.wikipedia.org/wiki/Mono_(software)\" onclick=\"event.stopPropagation()\">Mono\u003C/a>) interprets, compiles and runs the IL when the program is run. However this \u003Ca href=\"https://en.wikipedia.org/wiki/Just-in-time_compilation\" onclick=\"event.stopPropagation()\">just-in-time compiling\u003C/a> of the code adds overhead and for games, faster is better. This is why Unity built a tool called \u003Ca href=\"https://docs.unity3d.com/Manual/IL2CPP.html\" onclick=\"event.stopPropagation()\">IL2CPP\u003C/a>.\u003C/p>\n\u003Cp>IL2CPP transforms the IL into C++ code (as the name suggests). This C++ code can then be compiled to a particular CPU architecture, eliminating the overhead of an execution engine. One thing that is important to note though: usually in C++ the names of your variables and structures don't matter because they are all compiled down to memory addresses, but C# supports (and heavily uses) \u003Ca href=\"https://en.wikipedia.org/wiki/Reflective_programming\" onclick=\"event.stopPropagation()\">reflection\u003C/a> which allows code to introspect things like method names and types. IL2CPP outputs a file with all these symbols that the C++ code can use so that reflection features work. The compiled output (whether IL or IL2CPP binary) is a \u003Ccode>.dll\u003C/code> file that is known in C# terminology as an \u003Cem>assembly\u003C/em> (which is confusing because it is referring to a file containing machine code, while in computer science terminology the word assembly generally refers to a human-readable text format representing some machine code, and I'll be using this other definition further below when we get into disassembly).\u003C/p>\n\u003Cp>So now that we have some background on how the game is compiled and which data is available, we can get to the actual process of reverse engineering!\u003C/p>\n\u003Ch3 id=\"c-decompilers\">\u003Ca href=\"#c-decompilers\" role=\"img\" aria-label=\"Link to heading\" onclick=\"event.stopPropagation()\">\u003C/a>🪛 C# decompilers\u003C/h3>\n\u003Cblockquote>\n\u003Cp>dnSpy and ILSpy allow reading compiled C# code but won't work for Boneworks because of IL2CPP.\u003C/p>\n\u003C/blockquote>\n\u003Cp>\u003Ca href=\"https://github.com/dnSpy/dnSpy\" onclick=\"event.stopPropagation()\">dnSpy\u003C/a> is a popular tool which can do things like showing, debugging and editing C# code for a game. But this only works for IL (because IL instructions are similar to actual C# code) and doesn't work for IL2CPP assemblies. The tool has also been archived by the owner, so is no longer under development.\u003C/p>\n\u003Cp>\u003Ca href=\"https://github.com/icsharpcode/ILSpy\" onclick=\"event.stopPropagation()\">ILSpy\u003C/a> is another tool which does the same thing as dnSpy but seems less friendly. It is older and still actively developed though.\u003C/p>\n\u003Cp>It would be great if I could open Boneworks with these tools since it would be really easy to read the C# code and see what the boss claw logic is, but ultimately it's not possible because they only read IL, not x86 binaries produced by IL2CPP. 🚧\u003C/p>\n\u003Ch3 id=\"il2cpp-reversers\">\u003Ca href=\"#il2cpp-reversers\" role=\"img\" aria-label=\"Link to heading\" onclick=\"event.stopPropagation()\">\u003C/a>🪄 IL2CPP reversers\u003C/h3>\n\u003Cblockquote>\n\u003Cp>Il2CppInspector outputs the classes/methods/properties, their types and locations in the assembly. Cpp2IL converts the assembly to IL (which can be used with dnSpy/ILSpy).\u003C/p>\n\u003C/blockquote>\n\u003Cp>\u003Ca href=\"https://github.com/djkaty/Il2CppInspector\" onclick=\"event.stopPropagation()\">Il2CppInspector\u003C/a> is a tool that reads the reflection metadata from a compiled IL2CPP project. This gives us a list of all the classes, methods and properties with types as well as the address where they are in the assembly. The author has a \u003Ca href=\"https://katyscode.wordpress.com/tag/il2cpp/\" onclick=\"event.stopPropagation()\">great blog series\u003C/a> that goes into how it works and the various obfuscation techniques game developers use to hide the reflection metadata from reverse engineering. It worked out of the box for Boneworks though (and the developers -- Stress Level Zero -- are modding-friendly by the way) so I had no issue with this. There are plenty of output options, like creating a C# project with class/method stubs, C headers and Python scripts to assign class/method names to locations in disassemblers.\u003C/p>\n\u003Cp>\u003Ca href=\"https://github.com/SamboyCoding/Cpp2IL\" onclick=\"event.stopPropagation()\">Cpp2IL\u003C/a> is a really interesting project that aims to reconstruct the IL from the compiled C++. C# decompilers like dnSpy/ILSpy can then be used to read the code in a much more friendly syntax than x86 assembly. I imagine IL2CPP produces a particular set of C++ code for some C# code, so that seems reversible but C++ to machine code can be very different, which is why it is so impressive that this project works at all. Unfortunately it's not perfect yet and there are many instances where it cannot reconstruct something and bails out of reconstructing the entire function.\u003C/p>\n\u003Ch3 id=\"x86-disassemblers\">\u003Ca href=\"#x86-disassemblers\" role=\"img\" aria-label=\"Link to heading\" onclick=\"event.stopPropagation()\">\u003C/a>🤖 x86 disassemblers\u003C/h3>\n\u003Cblockquote>\n\u003Cp>Disassemblers turn binary into assembly. IDA is probably the best x86 disassembler (but automatic subroutine renaming based on reflection metadata doesn't work on free version).\u003C/p>\n\u003C/blockquote>\n\u003Cp>Disassemblers turn machine code (eg. compiled C++, the raw 1s and 0s CPUs understand) into assembly (human-readable list of CPU instructions, not to be confused with C# assemblies which I mentioned above). There are many x86 disassemblers but two of the most popular are \u003Ca href=\"https://hex-rays.com/ida-free/\" onclick=\"event.stopPropagation()\">IDA\u003C/a> and \u003Ca href=\"https://ghidra-sre.org/\" onclick=\"event.stopPropagation()\">Ghidra\u003C/a>. IDA is better but many useful features are only in the paid version, while Ghidra is free and open-source. Il2CppInspector supports creating scripts for automatically renaming the subroutines identified by IDA and Ghidra to their real names based on the IL reflection metadata but unfortunately IDA free cannot run scripts and there were heaps of errors in the Ghidra file. 😕 In the end I just manually renamed subroutines every time I saw a \u003Ccode>call\u003C/code> instruction as I was reading the disassembled code by cross-referencing the called address with the table produced by Il2CppInspector. 😒\u003C/p>\n\u003Cp>Assembly code is pretty easy to read but hard to understand since it is so low-level. An example of assembly instructions is this:\u003C/p>\n\u003Cpre>\u003Ccode class=\"hljs language-x86asm\">\u003Cspan class=\"hljs-keyword\">add\u003C/span> \u003Cspan class=\"hljs-built_in\">rax\u003C/span>, \u003Cspan class=\"hljs-number\">100\u003C/span>   \u003Cspan class=\"hljs-comment\">; adds 100 to the rax register\u003C/span>\n\u003Cspan class=\"hljs-keyword\">add\u003C/span> \u003Cspan class=\"hljs-built_in\">rax\u003C/span>, \u003Cspan class=\"hljs-built_in\">rbx\u003C/span>   \u003Cspan class=\"hljs-comment\">; adds the value in rbx to rax\u003C/span>\n\u003Cspan class=\"hljs-keyword\">add\u003C/span> \u003Cspan class=\"hljs-built_in\">rax\u003C/span>, [\u003Cspan class=\"hljs-number\">100\u003C/span>] \u003Cspan class=\"hljs-comment\">; adds the value in memory at address 100 to rax\u003C/span>\n\u003Cspan class=\"hljs-keyword\">add\u003C/span> \u003Cspan class=\"hljs-built_in\">rax\u003C/span>, [\u003Cspan class=\"hljs-built_in\">rbx\u003C/span>] \u003Cspan class=\"hljs-comment\">; adds the value in memory at address pointed to by rbx to rax\u003C/span>\n\u003C/code>\u003C/pre>\n\u003Cp>Basically the CPU has several registers which store a small amount of data (eg. a 64-bit integer) and reads/executes instructions from memory which operate on these registers. As you read through the assembly code, you can look up what instructions do and what registers are generally used for on Google and in CPU reference manuals to gradually learn everything.\u003C/p>\n\u003Cp>I have some prior experience with x86 assembly so have no issues reading it but I'm not sure about conventions like where C++ usually stores arguments before calling another subroutine. Also there's just so much state you need to keep in your head to understand what's going on. 😵‍💫\u003C/p>\n\u003Ch3 id=\"inspecting-a-running-game\">\u003Ca href=\"#inspecting-a-running-game\" role=\"img\" aria-label=\"Link to heading\" onclick=\"event.stopPropagation()\">\u003C/a>⏯️ Inspecting a running game\u003C/h3>\n\u003Cblockquote>\n\u003Cp>The incredible UnityExplorer mod lets you view and edit classes/methods/properties while the game is running.\u003C/p>\n\u003C/blockquote>\n\u003Cp>There is an amazing mod called \u003Ca href=\"https://github.com/sinai-dev/UnityExplorer\" onclick=\"event.stopPropagation()\">UnityExplorer\u003C/a> which reads the reflection metadata of the running game and allows you to view classes, edit properties, call methods and even has a C# REPL where you can run any script you want. All in real time while the game is running! 🤯 This mod was extremely helpful to quickly figure out how the boss claw works.\u003C/p>\n\u003Ch2 id=\"reverse-engineering-the-boss-claw\">\u003Ca href=\"#reverse-engineering-the-boss-claw\" role=\"img\" aria-label=\"Link to heading\" onclick=\"event.stopPropagation()\">\u003C/a>🗜️ Reverse engineering the boss claw\u003C/h2>\n\u003Cp>Alright, we're finally ready to start figuring out the internals of the boss claw! First thing is to load up the game, go to Streets and play around with UnityExplorer while watching the boss claw: watch how properties change as it moves, hook into methods to see when they're called, manually change properties and call methods to see what they do. Through this I found that its behaviour is controlled by the \u003Ccode>BossClawAi\u003C/code> class (luckily to my surprise it was called the same thing in code as what the speedrunning community calls it) and I didn't spend time to learn \u003Cem>everything\u003C/em> but here's what I was able to infer about its properties and methods:\u003C/p>\n\u003Cpre>\u003Ccode class=\"hljs language-c#\">\u003Cspan class=\"hljs-keyword\">public\u003C/span> \u003Cspan class=\"hljs-keyword\">class\u003C/span> \u003Cspan class=\"hljs-title\">BossClawAi\u003C/span> : \u003Cspan class=\"hljs-title\">MonoBehaviour\u003C/span>\n{\n    \u003Cspan class=\"hljs-comment\">// === Important things for boss claw RNG! ===\u003C/span>\n\n    \u003Cspan class=\"hljs-comment\">// The position it starts at (in the middle of the street)\u003C/span>\n    \u003Cspan class=\"hljs-keyword\">public\u003C/span> Vector3 _homePosition { \u003Cspan class=\"hljs-keyword\">get\u003C/span>; \u003Cspan class=\"hljs-keyword\">set\u003C/span>; }\n    \u003Cspan class=\"hljs-comment\">// A plane that extends this many units from _homePosition in X and Z\u003C/span>\n    \u003Cspan class=\"hljs-comment\">// directions. When patrolling it will choose a random point on this plane\u003C/span>\n    \u003Cspan class=\"hljs-comment\">// to patrol to. The Z component is 0 (I assume an early version of the claw\u003C/span>\n    \u003Cspan class=\"hljs-comment\">// behaved more like an arcade machine claw which can move in two dimensions\u003C/span>\n    \u003Cspan class=\"hljs-comment\">// but the mechanics of the overhead arms would be complicated for it to go\u003C/span>\n    \u003Cspan class=\"hljs-comment\">// to the drop-off point so they made it held up by an overhead track\u003C/span>\n    \u003Cspan class=\"hljs-comment\">// instead and just reduced the Z to 0 to stay on the track).\u003C/span>\n    \u003Cspan class=\"hljs-keyword\">public\u003C/span> Vector2 patrolXz { \u003Cspan class=\"hljs-keyword\">get\u003C/span>; \u003Cspan class=\"hljs-keyword\">set\u003C/span>; }\n    \u003Cspan class=\"hljs-comment\">// Manages pathing, movement and current target position. The claw is very\u003C/span>\n    \u003Cspan class=\"hljs-comment\">// simple so barely needs an AI but it does have to go around a corner to\u003C/span>\n    \u003Cspan class=\"hljs-comment\">// reach the drop-off point so I guess it makes sense to have one.\u003C/span>\n    \u003Cspan class=\"hljs-keyword\">public\u003C/span> UnityEngine.AI.NavMeshAgent _navAgent { \u003Cspan class=\"hljs-keyword\">get\u003C/span>; \u003Cspan class=\"hljs-keyword\">set\u003C/span>; }\n    \u003Cspan class=\"hljs-comment\">// Called on each frame to perform claw logic.\u003C/span>\n    \u003Cspan class=\"hljs-function\">\u003Cspan class=\"hljs-keyword\">public\u003C/span> \u003Cspan class=\"hljs-keyword\">void\u003C/span> \u003Cspan class=\"hljs-title\">AiTick\u003C/span>()\u003C/span>;\n\n\n    \u003Cspan class=\"hljs-comment\">// === Others ===\u003C/span>\n\n    \u003Cspan class=\"hljs-comment\">// How often AiTick() is called.\u003C/span>\n    \u003Cspan class=\"hljs-keyword\">public\u003C/span> \u003Cspan class=\"hljs-built_in\">float\u003C/span> _aiTickFreq { \u003Cspan class=\"hljs-keyword\">get\u003C/span>; \u003Cspan class=\"hljs-keyword\">set\u003C/span>; }\n    \u003Cspan class=\"hljs-comment\">// Last time AiTick() was called.\u003C/span>\n    \u003Cspan class=\"hljs-keyword\">public\u003C/span> \u003Cspan class=\"hljs-built_in\">float\u003C/span> _lastAiTickTime { \u003Cspan class=\"hljs-keyword\">get\u003C/span>; \u003Cspan class=\"hljs-keyword\">set\u003C/span>; }\n    \u003Cspan class=\"hljs-comment\">// How often to move to a random patrol point.\u003C/span>\n    \u003Cspan class=\"hljs-keyword\">public\u003C/span> \u003Cspan class=\"hljs-built_in\">float\u003C/span> patrolFrequency { \u003Cspan class=\"hljs-keyword\">get\u003C/span>; \u003Cspan class=\"hljs-keyword\">set\u003C/span>; }\n    \u003Cspan class=\"hljs-comment\">// Time when it last moved to a random patrol point.\u003C/span>\n    \u003Cspan class=\"hljs-keyword\">public\u003C/span> \u003Cspan class=\"hljs-built_in\">float\u003C/span> _patrolTimer { \u003Cspan class=\"hljs-keyword\">get\u003C/span>; \u003Cspan class=\"hljs-keyword\">set\u003C/span>; }\n    \u003Cspan class=\"hljs-comment\">// List of targets it wants to pick up.\u003C/span>\n    \u003Cspan class=\"hljs-keyword\">public\u003C/span> List&#x3C;TriggerRefProxy> targetList { \u003Cspan class=\"hljs-keyword\">get\u003C/span>; \u003Cspan class=\"hljs-keyword\">set\u003C/span>; }\n    \u003Cspan class=\"hljs-comment\">// Target it's currently going for.\u003C/span>\n    \u003Cspan class=\"hljs-keyword\">public\u003C/span> TriggerRefProxy _activeTarget { \u003Cspan class=\"hljs-keyword\">get\u003C/span>; \u003Cspan class=\"hljs-keyword\">set\u003C/span>; }\n    \u003Cspan class=\"hljs-comment\">// Percentage it's currently extended to the ground.\u003C/span>\n    \u003Cspan class=\"hljs-keyword\">public\u003C/span> \u003Cspan class=\"hljs-built_in\">float\u003C/span> _curExtension { \u003Cspan class=\"hljs-keyword\">get\u003C/span>; \u003Cspan class=\"hljs-keyword\">set\u003C/span>; }\n    \u003Cspan class=\"hljs-comment\">// Speed it is extending to the ground.\u003C/span>\n    \u003Cspan class=\"hljs-keyword\">public\u003C/span> \u003Cspan class=\"hljs-built_in\">float\u003C/span> _extensionVelocity { \u003Cspan class=\"hljs-keyword\">get\u003C/span>; \u003Cspan class=\"hljs-keyword\">set\u003C/span>; }\n    \u003Cspan class=\"hljs-comment\">// Called when it has grabbed something.\u003C/span>\n    \u003Cspan class=\"hljs-function\">\u003Cspan class=\"hljs-keyword\">public\u003C/span> \u003Cspan class=\"hljs-built_in\">bool\u003C/span> \u003Cspan class=\"hljs-title\">CaughtPrey\u003C/span>()\u003C/span>;\n    \u003Cspan class=\"hljs-comment\">// Called on each frame.\u003C/span>\n    \u003Cspan class=\"hljs-function\">\u003Cspan class=\"hljs-keyword\">public\u003C/span> \u003Cspan class=\"hljs-keyword\">void\u003C/span> \u003Cspan class=\"hljs-title\">Update\u003C/span>()\u003C/span>;\n    \u003Cspan class=\"hljs-comment\">// Called on each frame.\u003C/span>\n    \u003Cspan class=\"hljs-function\">\u003Cspan class=\"hljs-keyword\">public\u003C/span> \u003Cspan class=\"hljs-keyword\">void\u003C/span> \u003Cspan class=\"hljs-title\">FixedUpdate\u003C/span>()\u003C/span>;\n    \u003Cspan class=\"hljs-comment\">// Called on load.\u003C/span>\n    \u003Cspan class=\"hljs-function\">\u003Cspan class=\"hljs-keyword\">public\u003C/span> \u003Cspan class=\"hljs-keyword\">void\u003C/span> \u003Cspan class=\"hljs-title\">Awake\u003C/span>()\u003C/span>;\n    \u003Cspan class=\"hljs-comment\">// Change state.\u003C/span>\n    \u003Cspan class=\"hljs-function\">\u003Cspan class=\"hljs-keyword\">public\u003C/span> \u003Cspan class=\"hljs-keyword\">void\u003C/span> \u003Cspan class=\"hljs-title\">SwitchMentalState\u003C/span>(\u003Cspan class=\"hljs-params\">MentalState mState\u003C/span>)\u003C/span>;\n    \u003Cspan class=\"hljs-comment\">// Change state.\u003C/span>\n    \u003Cspan class=\"hljs-function\">\u003Cspan class=\"hljs-keyword\">public\u003C/span> \u003Cspan class=\"hljs-keyword\">void\u003C/span> \u003Cspan class=\"hljs-title\">SwitchPounceState\u003C/span>(\u003Cspan class=\"hljs-params\">PounceState pState\u003C/span>)\u003C/span>;\n    \u003Cspan class=\"hljs-comment\">// Set whether to show the blue barrier when picking something up.\u003C/span>\n    \u003Cspan class=\"hljs-function\">\u003Cspan class=\"hljs-keyword\">public\u003C/span> \u003Cspan class=\"hljs-keyword\">void\u003C/span> \u003Cspan class=\"hljs-title\">ToggleScoop\u003C/span>(\u003Cspan class=\"hljs-params\">\u003Cspan class=\"hljs-built_in\">bool\u003C/span> toggleOn\u003C/span>)\u003C/span>;\n    \u003Cspan class=\"hljs-comment\">// Starts calling AiTick() on each frame. Claw becomes active after jumping\u003C/span>\n    \u003Cspan class=\"hljs-comment\">// the wall in a run. Before then it just sits at the home position. I\u003C/span>\n    \u003Cspan class=\"hljs-comment\">// assume this is for performance since the player won't see the claw when\u003C/span>\n    \u003Cspan class=\"hljs-comment\">// they're somewhere else.\u003C/span>\n    \u003Cspan class=\"hljs-function\">\u003Cspan class=\"hljs-keyword\">public\u003C/span> \u003Cspan class=\"hljs-keyword\">void\u003C/span> \u003Cspan class=\"hljs-title\">SetActive\u003C/span>()\u003C/span>;\n    \u003Cspan class=\"hljs-comment\">// Stop calling AiTick().\u003C/span>\n    \u003Cspan class=\"hljs-function\">\u003Cspan class=\"hljs-keyword\">public\u003C/span> \u003Cspan class=\"hljs-keyword\">void\u003C/span> \u003Cspan class=\"hljs-title\">SetDeactive\u003C/span>()\u003C/span>;\n\n    \u003Cspan class=\"hljs-comment\">// === State === (including config for default)\u003C/span>\n    \u003Cspan class=\"hljs-keyword\">public\u003C/span> MentalState _defaultState { \u003Cspan class=\"hljs-keyword\">get\u003C/span>; \u003Cspan class=\"hljs-keyword\">set\u003C/span>; }\n    \u003Cspan class=\"hljs-keyword\">public\u003C/span> PounceState _pounceState { \u003Cspan class=\"hljs-keyword\">get\u003C/span>; \u003Cspan class=\"hljs-keyword\">set\u003C/span>; }\n    \u003Cspan class=\"hljs-keyword\">public\u003C/span> MentalState _mentalState { \u003Cspan class=\"hljs-keyword\">get\u003C/span>; \u003Cspan class=\"hljs-keyword\">set\u003C/span>; }\n\n    \u003Cspan class=\"hljs-comment\">// === Config for movement ===\u003C/span>\n    \u003Cspan class=\"hljs-keyword\">public\u003C/span> \u003Cspan class=\"hljs-built_in\">float\u003C/span> _baseAcceleration { \u003Cspan class=\"hljs-keyword\">get\u003C/span>; \u003Cspan class=\"hljs-keyword\">set\u003C/span>; }\n    \u003Cspan class=\"hljs-keyword\">public\u003C/span> \u003Cspan class=\"hljs-built_in\">float\u003C/span> acceleration { \u003Cspan class=\"hljs-keyword\">get\u003C/span>; \u003Cspan class=\"hljs-keyword\">set\u003C/span>; }\n    \u003Cspan class=\"hljs-keyword\">public\u003C/span> \u003Cspan class=\"hljs-built_in\">float\u003C/span> speed { \u003Cspan class=\"hljs-keyword\">get\u003C/span>; \u003Cspan class=\"hljs-keyword\">set\u003C/span>; }\n\n    \u003Cspan class=\"hljs-comment\">// === Config for when it is attempting to grab something ===\u003C/span>\n    \u003Cspan class=\"hljs-keyword\">public\u003C/span> \u003Cspan class=\"hljs-built_in\">float\u003C/span> pounceSpeedMult { \u003Cspan class=\"hljs-keyword\">get\u003C/span>; \u003Cspan class=\"hljs-keyword\">set\u003C/span>; }\n    \u003Cspan class=\"hljs-keyword\">public\u003C/span> \u003Cspan class=\"hljs-built_in\">float\u003C/span> pounceAccelMult { \u003Cspan class=\"hljs-keyword\">get\u003C/span>; \u003Cspan class=\"hljs-keyword\">set\u003C/span>; }\n    \u003Cspan class=\"hljs-keyword\">public\u003C/span> \u003Cspan class=\"hljs-built_in\">float\u003C/span> pounceSpringMult { \u003Cspan class=\"hljs-keyword\">get\u003C/span>; \u003Cspan class=\"hljs-keyword\">set\u003C/span>; }\n    \u003Cspan class=\"hljs-keyword\">public\u003C/span> \u003Cspan class=\"hljs-built_in\">float\u003C/span> pounceDamperMult { \u003Cspan class=\"hljs-keyword\">get\u003C/span>; \u003Cspan class=\"hljs-keyword\">set\u003C/span>; }\n    \u003Cspan class=\"hljs-keyword\">public\u003C/span> \u003Cspan class=\"hljs-built_in\">float\u003C/span> maxExtension { \u003Cspan class=\"hljs-keyword\">get\u003C/span>; \u003Cspan class=\"hljs-keyword\">set\u003C/span>; }\n    \u003Cspan class=\"hljs-keyword\">public\u003C/span> \u003Cspan class=\"hljs-built_in\">float\u003C/span> extensionTime { \u003Cspan class=\"hljs-keyword\">get\u003C/span>; \u003Cspan class=\"hljs-keyword\">set\u003C/span>; }\n\n    \u003Cspan class=\"hljs-comment\">// === Config for springiness when it's picking something up ===\u003C/span>\n    \u003Cspan class=\"hljs-keyword\">public\u003C/span> \u003Cspan class=\"hljs-built_in\">float\u003C/span> scoopSpringXz { \u003Cspan class=\"hljs-keyword\">get\u003C/span>; \u003Cspan class=\"hljs-keyword\">set\u003C/span>; }\n    \u003Cspan class=\"hljs-keyword\">public\u003C/span> \u003Cspan class=\"hljs-built_in\">float\u003C/span> scoopDamperXz { \u003Cspan class=\"hljs-keyword\">get\u003C/span>; \u003Cspan class=\"hljs-keyword\">set\u003C/span>; }\n    \u003Cspan class=\"hljs-keyword\">public\u003C/span> \u003Cspan class=\"hljs-built_in\">float\u003C/span> retractionTime { \u003Cspan class=\"hljs-keyword\">get\u003C/span>; \u003Cspan class=\"hljs-keyword\">set\u003C/span>; }\n\n    \u003Cspan class=\"hljs-comment\">// === Physics ===\u003C/span>\n    \u003Cspan class=\"hljs-comment\">// (for moving the segments between the top and bottom of the claw)\u003C/span>\n    \u003Cspan class=\"hljs-keyword\">public\u003C/span> Rigidbody _baseRb { \u003Cspan class=\"hljs-keyword\">get\u003C/span>; \u003Cspan class=\"hljs-keyword\">set\u003C/span>; }\n    \u003Cspan class=\"hljs-keyword\">public\u003C/span> ConfigurableJoint _jointBase { \u003Cspan class=\"hljs-keyword\">get\u003C/span>; \u003Cspan class=\"hljs-keyword\">set\u003C/span>; }\n    \u003Cspan class=\"hljs-keyword\">public\u003C/span> ConfigurableJoint _jointSpineA { \u003Cspan class=\"hljs-keyword\">get\u003C/span>; \u003Cspan class=\"hljs-keyword\">set\u003C/span>; }\n    \u003Cspan class=\"hljs-keyword\">public\u003C/span> ConfigurableJoint _jointSpineB { \u003Cspan class=\"hljs-keyword\">get\u003C/span>; \u003Cspan class=\"hljs-keyword\">set\u003C/span>; }\n    \u003Cspan class=\"hljs-keyword\">public\u003C/span> ConfigurableJoint _jointSpineC { \u003Cspan class=\"hljs-keyword\">get\u003C/span>; \u003Cspan class=\"hljs-keyword\">set\u003C/span>; }\n    \u003Cspan class=\"hljs-keyword\">public\u003C/span> ConfigurableJoint _jointCabin { \u003Cspan class=\"hljs-keyword\">get\u003C/span>; \u003Cspan class=\"hljs-keyword\">set\u003C/span>; }\n\n    \u003Cspan class=\"hljs-comment\">// === Audio ===\u003C/span>\n    \u003Cspan class=\"hljs-keyword\">public\u003C/span> UnityEngine.Audio.AudioMixerGroup _mixerGroup { \u003Cspan class=\"hljs-keyword\">get\u003C/span>; \u003Cspan class=\"hljs-keyword\">set\u003C/span>; }\n    \u003Cspan class=\"hljs-keyword\">public\u003C/span> AudioPlayer _articulationPlayer { \u003Cspan class=\"hljs-keyword\">get\u003C/span>; \u003Cspan class=\"hljs-keyword\">set\u003C/span>; }\n    \u003Cspan class=\"hljs-keyword\">public\u003C/span> AudioPlayer _movementPlayer { \u003Cspan class=\"hljs-keyword\">get\u003C/span>; \u003Cspan class=\"hljs-keyword\">set\u003C/span>; }\n    \u003Cspan class=\"hljs-keyword\">public\u003C/span> UnityEngine.AudioClip movementLoop { \u003Cspan class=\"hljs-keyword\">get\u003C/span>; \u003Cspan class=\"hljs-keyword\">set\u003C/span>; }\n    \u003Cspan class=\"hljs-keyword\">public\u003C/span> UnityEngine.AudioClip articulationLoop { \u003Cspan class=\"hljs-keyword\">get\u003C/span>; \u003Cspan class=\"hljs-keyword\">set\u003C/span>; }\n    \u003Cspan class=\"hljs-keyword\">public\u003C/span> UnityEngine.AudioClip charge { \u003Cspan class=\"hljs-keyword\">get\u003C/span>; \u003Cspan class=\"hljs-keyword\">set\u003C/span>; }\n    \u003Cspan class=\"hljs-keyword\">public\u003C/span> UnityEngine.AudioClip _scoopOn { \u003Cspan class=\"hljs-keyword\">get\u003C/span>; \u003Cspan class=\"hljs-keyword\">set\u003C/span>; }\n    \u003Cspan class=\"hljs-keyword\">public\u003C/span> UnityEngine.AudioClip _scoopOff { \u003Cspan class=\"hljs-keyword\">get\u003C/span>; \u003Cspan class=\"hljs-keyword\">set\u003C/span>; }\n    \u003Cspan class=\"hljs-function\">\u003Cspan class=\"hljs-keyword\">public\u003C/span> \u003Cspan class=\"hljs-keyword\">void\u003C/span> \u003Cspan class=\"hljs-title\">AttenuateMovementLoop\u003C/span>(\u003Cspan class=\"hljs-params\">\u003Cspan class=\"hljs-keyword\">ref\u003C/span> AudioPlayer player, Transform parentTransform, \u003Cspan class=\"hljs-built_in\">float\u003C/span> volume, \u003Cspan class=\"hljs-built_in\">float\u003C/span> pitch\u003C/span>)\u003C/span>;\n\n    \u003Cspan class=\"hljs-comment\">// === Not totally sure about the rest of these ===\u003C/span>\n    \u003Cspan class=\"hljs-comment\">// Maybe AiTick() debounces and this bypasses that on next call?\u003C/span>\n    \u003Cspan class=\"hljs-keyword\">public\u003C/span> \u003Cspan class=\"hljs-built_in\">bool\u003C/span> _forceAiTick { \u003Cspan class=\"hljs-keyword\">get\u003C/span>; \u003Cspan class=\"hljs-keyword\">set\u003C/span>; }\n    \u003Cspan class=\"hljs-comment\">// Decides which objects it should try to pick up?\u003C/span>\n    \u003Cspan class=\"hljs-keyword\">public\u003C/span> LayerMask preyLayers { \u003Cspan class=\"hljs-keyword\">get\u003C/span>; \u003Cspan class=\"hljs-keyword\">set\u003C/span>; }\n    \u003Cspan class=\"hljs-comment\">// Map of targets to something?\u003C/span>\n    \u003Cspan class=\"hljs-keyword\">public\u003C/span> Dictionary&#x3C;TriggerRefProxy, \u003Cspan class=\"hljs-built_in\">int\u003C/span>> _targetRefCount { \u003Cspan class=\"hljs-keyword\">get\u003C/span>; \u003Cspan class=\"hljs-keyword\">set\u003C/span>; }\n    \u003Cspan class=\"hljs-comment\">// Some kind of ID for the current target?\u003C/span>\n    \u003Cspan class=\"hljs-keyword\">public\u003C/span> \u003Cspan class=\"hljs-built_in\">ulong\u003C/span> _activeTargetId { \u003Cspan class=\"hljs-keyword\">get\u003C/span>; \u003Cspan class=\"hljs-keyword\">set\u003C/span>; }\n    \u003Cspan class=\"hljs-comment\">// How far it should extend downwards to pick up its target?\u003C/span>\n    \u003Cspan class=\"hljs-keyword\">public\u003C/span> \u003Cspan class=\"hljs-built_in\">float\u003C/span> _targetExtension { \u003Cspan class=\"hljs-keyword\">get\u003C/span>; \u003Cspan class=\"hljs-keyword\">set\u003C/span>; }\n    \u003Cspan class=\"hljs-comment\">// For timing when to pounce again after missing a pounce?\u003C/span>\n    \u003Cspan class=\"hljs-keyword\">public\u003C/span> \u003Cspan class=\"hljs-built_in\">float\u003C/span> _pounceTimer { \u003Cspan class=\"hljs-keyword\">get\u003C/span>; \u003Cspan class=\"hljs-keyword\">set\u003C/span>; }\n    \u003Cspan class=\"hljs-comment\">// What objects are inside the claw?\u003C/span>\n    \u003Cspan class=\"hljs-keyword\">public\u003C/span> Il2CppReferenceArray&#x3C;Collider> _boxCheckResults { \u003Cspan class=\"hljs-keyword\">get\u003C/span>; \u003Cspan class=\"hljs-keyword\">set\u003C/span>; }\n    \u003Cspan class=\"hljs-comment\">// The area inside the claw which counts as grabbed?\u003C/span>\n    \u003Cspan class=\"hljs-keyword\">public\u003C/span> Transform _boxCheck { \u003Cspan class=\"hljs-keyword\">get\u003C/span>; \u003Cspan class=\"hljs-keyword\">set\u003C/span>; }\n    \u003Cspan class=\"hljs-comment\">// Where to drop off grabbed objects?\u003C/span>\n    \u003Cspan class=\"hljs-keyword\">public\u003C/span> Transform unloadPoint { \u003Cspan class=\"hljs-keyword\">get\u003C/span>; \u003Cspan class=\"hljs-keyword\">set\u003C/span>; }\n    \u003Cspan class=\"hljs-comment\">// ?\u003C/span>\n    \u003Cspan class=\"hljs-keyword\">public\u003C/span> Vector3 _scoopDisplace { \u003Cspan class=\"hljs-keyword\">get\u003C/span>; \u003Cspan class=\"hljs-keyword\">set\u003C/span>; }\n    \u003Cspan class=\"hljs-comment\">// ?\u003C/span>\n    \u003Cspan class=\"hljs-keyword\">public\u003C/span> Il2CppReferenceArray&#x3C;GameObject> _scoopObjects { \u003Cspan class=\"hljs-keyword\">get\u003C/span>; \u003Cspan class=\"hljs-keyword\">set\u003C/span>; }\n    \u003Cspan class=\"hljs-comment\">// ?\u003C/span>\n    \u003Cspan class=\"hljs-function\">\u003Cspan class=\"hljs-keyword\">public\u003C/span> \u003Cspan class=\"hljs-keyword\">void\u003C/span> \u003Cspan class=\"hljs-title\">CheckTarget\u003C/span>()\u003C/span>;\n    \u003Cspan class=\"hljs-comment\">// Stops moving?\u003C/span>\n    \u003Cspan class=\"hljs-function\">\u003Cspan class=\"hljs-keyword\">public\u003C/span> \u003Cspan class=\"hljs-keyword\">void\u003C/span> \u003Cspan class=\"hljs-title\">ClearPath\u003C/span>()\u003C/span>;\n    \u003Cspan class=\"hljs-comment\">// Move to somewhere?\u003C/span>\n    \u003Cspan class=\"hljs-function\">\u003Cspan class=\"hljs-keyword\">public\u003C/span> \u003Cspan class=\"hljs-keyword\">void\u003C/span> \u003Cspan class=\"hljs-title\">SetPath\u003C/span>(\u003Cspan class=\"hljs-params\">Vector3 target\u003C/span>)\u003C/span>;\n    \u003Cspan class=\"hljs-comment\">// How \"diagonal\" the claw is as it extends?\u003C/span>\n    \u003Cspan class=\"hljs-function\">\u003Cspan class=\"hljs-keyword\">public\u003C/span> \u003Cspan class=\"hljs-keyword\">void\u003C/span> \u003Cspan class=\"hljs-title\">SetScoopXzDrives\u003C/span>(\u003Cspan class=\"hljs-params\">\u003Cspan class=\"hljs-built_in\">float\u003C/span> spring, \u003Cspan class=\"hljs-built_in\">float\u003C/span> damper\u003C/span>)\u003C/span>;\n    \u003Cspan class=\"hljs-comment\">// ?\u003C/span>\n    \u003Cspan class=\"hljs-function\">\u003Cspan class=\"hljs-keyword\">public\u003C/span> \u003Cspan class=\"hljs-keyword\">void\u003C/span> \u003Cspan class=\"hljs-title\">TriggerStateChange\u003C/span>(\u003Cspan class=\"hljs-params\">TriggerRefProxy trp, \u003Cspan class=\"hljs-built_in\">bool\u003C/span> enter = \u003Cspan class=\"hljs-literal\">true\u003C/span>\u003C/span>)\u003C/span>;\n\n    \u003Cspan class=\"hljs-comment\">// === Different possible states ===\u003C/span>\n    \u003Cspan class=\"hljs-keyword\">public\u003C/span> \u003Cspan class=\"hljs-built_in\">enum\u003C/span> MentalState\n    {\n        Rest = \u003Cspan class=\"hljs-number\">0\u003C/span>,\n        Patrol = \u003Cspan class=\"hljs-number\">1\u003C/span>,\n        Pounce = \u003Cspan class=\"hljs-number\">2\u003C/span>,\n        Unload = \u003Cspan class=\"hljs-number\">3\u003C/span>\n    }\n    \u003Cspan class=\"hljs-keyword\">public\u003C/span> \u003Cspan class=\"hljs-built_in\">enum\u003C/span> PounceState\n    {\n        Charge = \u003Cspan class=\"hljs-number\">0\u003C/span>,\n        Drop = \u003Cspan class=\"hljs-number\">1\u003C/span>,\n        Scoop = \u003Cspan class=\"hljs-number\">2\u003C/span>,\n        Check = \u003Cspan class=\"hljs-number\">3\u003C/span>\n    }\n}\n\u003C/code>\u003C/pre>\n\u003Cp>Note that many of these types (eg. \u003Ca href=\"https://docs.unity3d.com/ScriptReference/AI.NavMeshAgent.html\" onclick=\"event.stopPropagation()\">\u003Ccode>UnityEngine.AI.NavMeshAgent\u003C/code>\u003C/a> or \u003Ca href=\"https://docs.unity3d.com/ScriptReference/Vector3.html\" onclick=\"event.stopPropagation()\">\u003Ccode>Vector3\u003C/code>\u003C/a>) can be looked up in the Unity documentation to understand how they work.\u003C/p>\n\u003Ch3 id=\"building-the-mod\">\u003Ca href=\"#building-the-mod\" role=\"img\" aria-label=\"Link to heading\" onclick=\"event.stopPropagation()\">\u003C/a>🧑‍💻 Building the mod\u003C/h3>\n\u003Cp>From this I had all the information I needed to build a mod which makes the boss claw patrol to the finish of the level 100% of the time. Using the \u003Ccode>OnSceneWasInitialized\u003C/code> hook in the \u003Ca href=\"https://melonwiki.xyz/\" onclick=\"event.stopPropagation()\">MelonLoader mod framework\u003C/a> I found the \u003Ccode>BossClawAi\u003C/code> by using the standard Unity APIs (\u003Ccode>FindObjectOfType()\u003C/code>) and simply changed the \u003Ccode>_homePosition\u003C/code> to the point where I wanted the claw to go and set \u003Ccode>patrolXz\u003C/code> to \u003Ccode>(0, 0)\u003C/code> so it would always go to exactly that point.\u003C/p>\n\u003Cp>Since there was the possibility of cheating runs with this mod (consciously or accidentally) I also had it paint the boss claw green so it's obvious the mod is active.\u003C/p>\n\u003Cp>Also interesting to note here is that MelonLoader comes with a library called \u003Ca href=\"https://harmony.pardeike.net/\" onclick=\"event.stopPropagation()\">Harmony\u003C/a> which allows \"patching\" methods. This replaces the code at the memory address of the method with a stub that calls your \u003Ccode>Prefix\u003C/code> handler, the original method, then your \u003Ccode>Postfix\u003C/code> handler. I didn't need to use it for my mod though, since I could do everything with standard Unity APIs and the built-in MelonLoader hooks.\u003C/p>\n\u003Ch4 id=\"links\">\u003Ca href=\"#links\" role=\"img\" aria-label=\"Link to heading\" onclick=\"event.stopPropagation()\">\u003C/a>Links\u003C/h4>\n\u003Cp>If you're interested in the mod, here are the links to download and see the code:\u003C/p>\n\u003Cul>\n\u003Cli>Installation link: \u003Ca href=\"https://boneworks.thunderstore.io/package/jakzo/SpeedrunTools/\" onclick=\"event.stopPropagation()\">https://boneworks.thunderstore.io/package/jakzo/SpeedrunTools/\u003C/a>\u003C/li>\n\u003Cli>Mod repository: \u003Ca href=\"https://github.com/jakzo/BoneworksSpeedrunTools\" onclick=\"event.stopPropagation()\">https://github.com/jakzo/BoneworksSpeedrunTools\u003C/a>\u003C/li>\n\u003C/ul>\n\u003Ch3 id=\"decompiling-the-code\">\u003Ca href=\"#decompiling-the-code\" role=\"img\" aria-label=\"Link to heading\" onclick=\"event.stopPropagation()\">\u003C/a>🔍 Decompiling the code\u003C/h3>\n\u003Cblockquote>\n\u003Cp>⚠️ These days I have a better workflow. This post still has some useful information but if you to decompile a game for modding I recommend following the steps in my newer post here: \u003Ca href=\"./modding-unity-il2cpp-games\" onclick=\"event.stopPropagation()\">🧰 Modding Unity IL2CPP Games\u003C/a>\u003C/p>\n\u003C/blockquote>\n\u003Cp>I still wanted to know if the point it goes to was truly random though. To do this I used Cpp2IL to decompile the IL2CPP assembly back into IL using this command:\u003C/p>\n\u003Cpre>\u003Ccode class=\"hljs language-powershell\">.\\Cpp2IL\u003Cspan class=\"hljs-literal\">-2022\u003C/span>.\u003Cspan class=\"hljs-number\">0.5\u003C/span>\u003Cspan class=\"hljs-literal\">-Windows\u003C/span>.exe \u003Cspan class=\"hljs-literal\">--game-path\u003C/span> \u003Cspan class=\"hljs-string\">\"C:\\Program Files (x86)\\Steam\\steamapps\\common\\BONEWORKS\\BONEWORKS\"\u003C/span> \u003Cspan class=\"hljs-literal\">--experimental-enable-il-to-assembly-please\u003C/span>\n\u003C/code>\u003C/pre>\n\u003Cp>The success rate of decompilation was 47% and unfortunately when I opened the output in dnSpy I found that \u003Ccode>AiTick()\u003C/code> failed to decompile. 🙁\u003C/p>\n\u003Cp>Output:\u003C/p>\n\u003Cpre>\u003Ccode class=\"hljs language-css\">\u003Cspan class=\"hljs-selector-attr\">[Info]\u003C/span> \u003Cspan class=\"hljs-selector-attr\">[Program]\u003C/span> Overall analysis success rate: \u003Cspan class=\"hljs-number\">47%\u003C/span> (\u003Cspan class=\"hljs-number\">8617\u003C/span>) of \u003Cspan class=\"hljs-number\">18267\u003C/span> methods.\n\u003C/code>\u003C/pre>\n\u003Cp>What dnSpy shows:\u003C/p>\n\u003Cpre>\u003Ccode class=\"hljs language-c#\">\u003Cspan class=\"hljs-comment\">// Token: 0x0600074B RID: 1867 RVA: 0x00002050 File Offset: 0x00000250\u003C/span>\n[\u003Cspan class=\"hljs-meta\">Token(Token = \u003Cspan class=\"hljs-string\">\"0x600055C\"\u003C/span>)\u003C/span>]\n[\u003Cspan class=\"hljs-meta\">Address(RVA = \u003Cspan class=\"hljs-string\">\"0x4EB1A0\"\u003C/span>, Offset = \u003Cspan class=\"hljs-string\">\"0x4E99A0\"\u003C/span>, VA = \u003Cspan class=\"hljs-string\">\"0x1804EB1A0\"\u003C/span>)\u003C/span>]\n\u003Cspan class=\"hljs-function\">\u003Cspan class=\"hljs-keyword\">private\u003C/span> \u003Cspan class=\"hljs-keyword\">void\u003C/span> \u003Cspan class=\"hljs-title\">AiTick\u003C/span>()\u003C/span>\n{\n    \u003Cspan class=\"hljs-keyword\">throw\u003C/span> \u003Cspan class=\"hljs-keyword\">new\u003C/span> AnalysisFailedException(\u003Cspan class=\"hljs-string\">\"CPP2IL failed to recover any usable IL for this method.\"\u003C/span>);\n}\n\u003C/code>\u003C/pre>\n\u003Ch3 id=\"disassembling-the-code\">\u003Ca href=\"#disassembling-the-code\" role=\"img\" aria-label=\"Link to heading\" onclick=\"event.stopPropagation()\">\u003C/a>🔬 Disassembling the code\u003C/h3>\n\u003Cp>My backup plan was to read the assembly directly, so I loaded the game's assembly (\u003Ccode>GameAssembly.dll\u003C/code>) into IDA. In addition to just converting the machine code, IDA analyses and works out the boundaries of all the subroutines and displays the disassembled code in a nice graph format. I ran Il2CppInspector on the game to find the address of \u003Ccode>BossClawAi.AiTick()\u003C/code> and opened the subroutine graph at that address, since the logic for deciding where to go is probably in here. I knew that there should be a call to \u003Ccode>NavMeshAgent.SetDestination()\u003C/code> just after it figures out the point it wants to patrol to so I searched for calls to its address in this subroutine and found a few of them. For each of these calls I worked backwards through the code, renaming any \u003Ccode>call\u003C/code> instructions as I came across them to change the opaque memory address into a function name by cross-referencing the address with Il2CppInspector's output. Eventually I found what I think is the call that sends the boss claw to patrol.\u003C/p>\n\u003Cp>The segment of assembly from IDA that sends the boss claw to a random point (with comments added by me):\u003C/p>\n\u003Cpre>\u003Ccode class=\"hljs language-x86asm\">\u003Cspan class=\"hljs-symbol\">loc_1804EC38A:\u003C/span>                          \u003Cspan class=\"hljs-comment\">; CODE XREF: sub_1804EB1A0+118C↑j\u003C/span>\n                                        \u003Cspan class=\"hljs-comment\">; sub_1804EB1A0+11D4↑j\u003C/span>\n                \u003Cspan class=\"hljs-keyword\">movss\u003C/span>   \u003Cspan class=\"hljs-built_in\">xmm6\u003C/span>, \u003Cspan class=\"hljs-built_in\">dword\u003C/span> \u003Cspan class=\"hljs-built_in\">ptr\u003C/span> [\u003Cspan class=\"hljs-built_in\">rdi\u003C/span>+\u003Cspan class=\"hljs-number\">108h\u003C/span>]\n                \u003Cspan class=\"hljs-keyword\">xor\u003C/span>     \u003Cspan class=\"hljs-built_in\">ecx\u003C/span>, \u003Cspan class=\"hljs-built_in\">ecx\u003C/span>\n                \u003Cspan class=\"hljs-keyword\">call\u003C/span>    Time_get_time\n                \u003Cspan class=\"hljs-keyword\">comiss\u003C/span>  \u003Cspan class=\"hljs-built_in\">xmm6\u003C/span>, \u003Cspan class=\"hljs-built_in\">xmm0\u003C/span>\n                \u003Cspan class=\"hljs-keyword\">ja\u003C/span>      loc_1804EBB03\n                \u003Cspan class=\"hljs-keyword\">movss\u003C/span>   \u003Cspan class=\"hljs-built_in\">xmm6\u003C/span>, \u003Cspan class=\"hljs-built_in\">dword\u003C/span> \u003Cspan class=\"hljs-built_in\">ptr\u003C/span> [\u003Cspan class=\"hljs-built_in\">rdi\u003C/span>+\u003Cspan class=\"hljs-number\">70h\u003C/span>]\n                \u003Cspan class=\"hljs-keyword\">xor\u003C/span>     \u003Cspan class=\"hljs-built_in\">ecx\u003C/span>, \u003Cspan class=\"hljs-built_in\">ecx\u003C/span>\n                \u003Cspan class=\"hljs-keyword\">call\u003C/span>    Time_get_time\n                \u003Cspan class=\"hljs-keyword\">movss\u003C/span>   \u003Cspan class=\"hljs-built_in\">xmm1\u003C/span>, \u003Cspan class=\"hljs-built_in\">cs\u003C/span>:dword_1817BB6EC\n                \u003Cspan class=\"hljs-keyword\">xor\u003C/span>     \u003Cspan class=\"hljs-built_in\">ecx\u003C/span>, \u003Cspan class=\"hljs-built_in\">ecx\u003C/span>\n                \u003Cspan class=\"hljs-keyword\">movsd\u003C/span>   \u003Cspan class=\"hljs-built_in\">xmm8\u003C/span>, \u003Cspan class=\"hljs-built_in\">qword\u003C/span> \u003Cspan class=\"hljs-built_in\">ptr\u003C/span> [\u003Cspan class=\"hljs-built_in\">rdi\u003C/span>+\u003Cspan class=\"hljs-number\">118h\u003C/span>]\n                \u003Cspan class=\"hljs-keyword\">mov\u003C/span>     \u003Cspan class=\"hljs-built_in\">ebx\u003C/span>, [\u003Cspan class=\"hljs-built_in\">rdi\u003C/span>+\u003Cspan class=\"hljs-number\">120h\u003C/span>]\n                \u003Cspan class=\"hljs-keyword\">divss\u003C/span>   \u003Cspan class=\"hljs-built_in\">xmm1\u003C/span>, \u003Cspan class=\"hljs-built_in\">xmm6\u003C/span>\n                \u003Cspan class=\"hljs-keyword\">addss\u003C/span>   \u003Cspan class=\"hljs-built_in\">xmm0\u003C/span>, \u003Cspan class=\"hljs-built_in\">xmm1\u003C/span>\n                \u003Cspan class=\"hljs-keyword\">movss\u003C/span>   \u003Cspan class=\"hljs-built_in\">dword\u003C/span> \u003Cspan class=\"hljs-built_in\">ptr\u003C/span> [\u003Cspan class=\"hljs-built_in\">rdi\u003C/span>+\u003Cspan class=\"hljs-number\">108h\u003C/span>], \u003Cspan class=\"hljs-built_in\">xmm0\u003C/span>\n                \u003Cspan class=\"hljs-keyword\">call\u003C/span>    Random_1_get_value        \u003Cspan class=\"hljs-comment\">; xmm0 = randX = Random.value()\u003C/span>\n                \u003Cspan class=\"hljs-keyword\">movss\u003C/span>   \u003Cspan class=\"hljs-built_in\">xmm6\u003C/span>, \u003Cspan class=\"hljs-built_in\">dword\u003C/span> \u003Cspan class=\"hljs-built_in\">ptr\u003C/span> [\u003Cspan class=\"hljs-built_in\">rdi\u003C/span>+\u003Cspan class=\"hljs-number\">68h\u003C/span>] \u003Cspan class=\"hljs-comment\">; xmm6 = patrolXz.x\u003C/span>\n                \u003Cspan class=\"hljs-keyword\">xor\u003C/span>     \u003Cspan class=\"hljs-built_in\">ecx\u003C/span>, \u003Cspan class=\"hljs-built_in\">ecx\u003C/span>\n                \u003Cspan class=\"hljs-keyword\">movaps\u003C/span>  \u003Cspan class=\"hljs-built_in\">xmm7\u003C/span>, \u003Cspan class=\"hljs-built_in\">xmm0\u003C/span>                \u003Cspan class=\"hljs-comment\">; xmm7 = randX\u003C/span>\n                \u003Cspan class=\"hljs-keyword\">call\u003C/span>    Random_1_get_value        \u003Cspan class=\"hljs-comment\">; xmm0 = randZ = Random.value()\u003C/span>\n                \u003Cspan class=\"hljs-keyword\">movss\u003C/span>   \u003Cspan class=\"hljs-built_in\">xmm1\u003C/span>, \u003Cspan class=\"hljs-built_in\">dword\u003C/span> \u003Cspan class=\"hljs-built_in\">ptr\u003C/span> [\u003Cspan class=\"hljs-built_in\">rdi\u003C/span>+\u003Cspan class=\"hljs-number\">6Ch\u003C/span>] \u003Cspan class=\"hljs-comment\">; xmm1 = patrolXz.z\u003C/span>\n                \u003Cspan class=\"hljs-keyword\">lea\u003C/span>     \u003Cspan class=\"hljs-built_in\">rcx\u003C/span>, [\u003Cspan class=\"hljs-built_in\">rbp\u003C/span>+\u003Cspan class=\"hljs-number\">57h\u003C/span>+var_D0]\n                \u003Cspan class=\"hljs-keyword\">movaps\u003C/span>  \u003Cspan class=\"hljs-built_in\">xmm3\u003C/span>, \u003Cspan class=\"hljs-built_in\">xmm1\u003C/span>                \u003Cspan class=\"hljs-comment\">; xmm3 = patrolXz.z\u003C/span>\n                \u003Cspan class=\"hljs-keyword\">mulss\u003C/span>   \u003Cspan class=\"hljs-built_in\">xmm7\u003C/span>, \u003Cspan class=\"hljs-built_in\">xmm6\u003C/span>                \u003Cspan class=\"hljs-comment\">; xmm7 = randX * patrolXz.x\u003C/span>\n                \u003Cspan class=\"hljs-keyword\">xor\u003C/span>     \u003Cspan class=\"hljs-built_in\">eax\u003C/span>, \u003Cspan class=\"hljs-built_in\">eax\u003C/span>\n                \u003Cspan class=\"hljs-keyword\">mov\u003C/span>     [\u003Cspan class=\"hljs-built_in\">rsp\u003C/span>+\u003Cspan class=\"hljs-number\">110h\u003C/span>+var_F0], \u003Cspan class=\"hljs-built_in\">r14\u003C/span>\n                \u003Cspan class=\"hljs-keyword\">mulss\u003C/span>   \u003Cspan class=\"hljs-built_in\">xmm3\u003C/span>, \u003Cspan class=\"hljs-built_in\">xmm0\u003C/span>                \u003Cspan class=\"hljs-comment\">; xmm3 = patrolXz.z * randZ\u003C/span>\n                \u003Cspan class=\"hljs-keyword\">xorps\u003C/span>   \u003Cspan class=\"hljs-built_in\">xmm2\u003C/span>, \u003Cspan class=\"hljs-built_in\">xmm2\u003C/span>                \u003Cspan class=\"hljs-comment\">; xmm2 = 0\u003C/span>\n                \u003Cspan class=\"hljs-keyword\">mov\u003C/span>     [\u003Cspan class=\"hljs-built_in\">rbp\u003C/span>+\u003Cspan class=\"hljs-number\">57h\u003C/span>+var_D0], \u003Cspan class=\"hljs-built_in\">rax\u003C/span>\n                \u003Cspan class=\"hljs-keyword\">addss\u003C/span>   \u003Cspan class=\"hljs-built_in\">xmm7\u003C/span>, \u003Cspan class=\"hljs-built_in\">xmm7\u003C/span>                \u003Cspan class=\"hljs-comment\">; xmm7 = (randX * patrolXz.x) * 2\u003C/span>\n                \u003Cspan class=\"hljs-keyword\">mov\u003C/span>     [\u003Cspan class=\"hljs-built_in\">rbp\u003C/span>+\u003Cspan class=\"hljs-number\">57h\u003C/span>+var_C8], \u003Cspan class=\"hljs-built_in\">eax\u003C/span>\n                \u003Cspan class=\"hljs-keyword\">addss\u003C/span>   \u003Cspan class=\"hljs-built_in\">xmm3\u003C/span>, \u003Cspan class=\"hljs-built_in\">xmm3\u003C/span>                \u003Cspan class=\"hljs-comment\">; xmm3 = (patrolXz.z * randZ) * 2\u003C/span>\n                \u003Cspan class=\"hljs-keyword\">subss\u003C/span>   \u003Cspan class=\"hljs-built_in\">xmm7\u003C/span>, \u003Cspan class=\"hljs-built_in\">xmm6\u003C/span>                \u003Cspan class=\"hljs-comment\">; xmm7 = (randX * patrolXz.x) * 2 - patrolXz.x\u003C/span>\n                \u003Cspan class=\"hljs-keyword\">subss\u003C/span>   \u003Cspan class=\"hljs-built_in\">xmm3\u003C/span>, \u003Cspan class=\"hljs-built_in\">xmm1\u003C/span>                \u003Cspan class=\"hljs-comment\">; xmm3 = (patrolXz.z * randZ) * 2 - patrolXz.z\u003C/span>\n                \u003Cspan class=\"hljs-keyword\">movaps\u003C/span>  \u003Cspan class=\"hljs-built_in\">xmm1\u003C/span>, \u003Cspan class=\"hljs-built_in\">xmm7\u003C/span>                \u003Cspan class=\"hljs-comment\">; xmm1 = (randX * patrolXz.x) * 2 - patrolXz.x\u003C/span>\n                \u003Cspan class=\"hljs-keyword\">call\u003C/span>    Coord_1_ToVector3         \u003Cspan class=\"hljs-comment\">; randCoord = new Vector3(xmm1, xmm2, xmm3)\u003C/span>\n                \u003Cspan class=\"hljs-keyword\">mov\u003C/span>     \u003Cspan class=\"hljs-built_in\">rcx\u003C/span>, \u003Cspan class=\"hljs-built_in\">cs\u003C/span>:qword_181EA6150\n                \u003Cspan class=\"hljs-keyword\">test\u003C/span>    \u003Cspan class=\"hljs-built_in\">byte\u003C/span> \u003Cspan class=\"hljs-built_in\">ptr\u003C/span> [\u003Cspan class=\"hljs-built_in\">rcx\u003C/span>+\u003Cspan class=\"hljs-number\">127h\u003C/span>], \u003Cspan class=\"hljs-number\">2\u003C/span>\n                \u003Cspan class=\"hljs-keyword\">jz\u003C/span>      short loc_1804EC446\n                \u003Cspan class=\"hljs-keyword\">cmp\u003C/span>     [\u003Cspan class=\"hljs-built_in\">rcx\u003C/span>+\u003Cspan class=\"hljs-number\">0D8h\u003C/span>], \u003Cspan class=\"hljs-built_in\">r14d\u003C/span>\n                \u003Cspan class=\"hljs-keyword\">jnz\u003C/span>     short loc_1804EC446\n                \u003Cspan class=\"hljs-keyword\">call\u003C/span>    il2cpp_runtime_class_init_0\n\u003Cspan class=\"hljs-symbol\">loc_1804EC446:\u003C/span>                          \u003Cspan class=\"hljs-comment\">; CODE XREF: sub_1804EB1A0+1296↑j\u003C/span>\n                                        \u003Cspan class=\"hljs-comment\">; sub_1804EB1A0+129F↑j\u003C/span>\n                \u003Cspan class=\"hljs-keyword\">movsd\u003C/span>   \u003Cspan class=\"hljs-built_in\">xmm0\u003C/span>, [\u003Cspan class=\"hljs-built_in\">rbp\u003C/span>+\u003Cspan class=\"hljs-number\">57h\u003C/span>+var_D0]\n                \u003Cspan class=\"hljs-keyword\">lea\u003C/span>     \u003Cspan class=\"hljs-built_in\">r8\u003C/span>, [\u003Cspan class=\"hljs-built_in\">rsp\u003C/span>+\u003Cspan class=\"hljs-number\">110h\u003C/span>+var_E0]\n                \u003Cspan class=\"hljs-keyword\">mov\u003C/span>     \u003Cspan class=\"hljs-built_in\">eax\u003C/span>, [\u003Cspan class=\"hljs-built_in\">rbp\u003C/span>+\u003Cspan class=\"hljs-number\">57h\u003C/span>+var_C8]\n                \u003Cspan class=\"hljs-keyword\">lea\u003C/span>     \u003Cspan class=\"hljs-built_in\">rdx\u003C/span>, [\u003Cspan class=\"hljs-built_in\">rbp\u003C/span>+\u003Cspan class=\"hljs-number\">57h\u003C/span>+var_C0]\n                \u003Cspan class=\"hljs-keyword\">xor\u003C/span>     \u003Cspan class=\"hljs-built_in\">r9d\u003C/span>, \u003Cspan class=\"hljs-built_in\">r9d\u003C/span>\n                \u003Cspan class=\"hljs-keyword\">movsd\u003C/span>   [\u003Cspan class=\"hljs-built_in\">rsp\u003C/span>+\u003Cspan class=\"hljs-number\">110h\u003C/span>+var_E0], \u003Cspan class=\"hljs-built_in\">xmm0\u003C/span>\n                \u003Cspan class=\"hljs-keyword\">lea\u003C/span>     \u003Cspan class=\"hljs-built_in\">rcx\u003C/span>, [\u003Cspan class=\"hljs-built_in\">rbp\u003C/span>+\u003Cspan class=\"hljs-number\">57h\u003C/span>+var_90]\n                \u003Cspan class=\"hljs-keyword\">mov\u003C/span>     [\u003Cspan class=\"hljs-built_in\">rsp\u003C/span>+\u003Cspan class=\"hljs-number\">110h\u003C/span>+var_D8], \u003Cspan class=\"hljs-built_in\">eax\u003C/span>\n                \u003Cspan class=\"hljs-keyword\">movsd\u003C/span>   [\u003Cspan class=\"hljs-built_in\">rbp\u003C/span>+\u003Cspan class=\"hljs-number\">57h\u003C/span>+var_C0], \u003Cspan class=\"hljs-built_in\">xmm8\u003C/span>\n                \u003Cspan class=\"hljs-keyword\">mov\u003C/span>     [\u003Cspan class=\"hljs-built_in\">rbp\u003C/span>+\u003Cspan class=\"hljs-number\">57h\u003C/span>+var_B8], \u003Cspan class=\"hljs-built_in\">ebx\u003C/span>\n                \u003Cspan class=\"hljs-keyword\">call\u003C/span>    Vector3_op_Addition       \u003Cspan class=\"hljs-comment\">; finalPatrolPoint = randCoord + _homePosition\u003C/span>\n                \u003Cspan class=\"hljs-keyword\">mov\u003C/span>     \u003Cspan class=\"hljs-built_in\">rcx\u003C/span>, [\u003Cspan class=\"hljs-built_in\">rdi\u003C/span>+\u003Cspan class=\"hljs-number\">18h\u003C/span>]\n                \u003Cspan class=\"hljs-keyword\">test\u003C/span>    \u003Cspan class=\"hljs-built_in\">rcx\u003C/span>, \u003Cspan class=\"hljs-built_in\">rcx\u003C/span>\n                \u003Cspan class=\"hljs-keyword\">jz\u003C/span>      short loc_1804EC4B2\n                \u003Cspan class=\"hljs-keyword\">movsd\u003C/span>   \u003Cspan class=\"hljs-built_in\">xmm0\u003C/span>, \u003Cspan class=\"hljs-built_in\">qword\u003C/span> \u003Cspan class=\"hljs-built_in\">ptr\u003C/span> [\u003Cspan class=\"hljs-built_in\">rax\u003C/span>]\n                \u003Cspan class=\"hljs-keyword\">lea\u003C/span>     \u003Cspan class=\"hljs-built_in\">rdx\u003C/span>, [\u003Cspan class=\"hljs-built_in\">rsp\u003C/span>+\u003Cspan class=\"hljs-number\">110h\u003C/span>+var_E0]\n                \u003Cspan class=\"hljs-keyword\">mov\u003C/span>     \u003Cspan class=\"hljs-built_in\">eax\u003C/span>, [\u003Cspan class=\"hljs-built_in\">rax\u003C/span>+\u003Cspan class=\"hljs-number\">8\u003C/span>]\n                \u003Cspan class=\"hljs-keyword\">xor\u003C/span>     \u003Cspan class=\"hljs-built_in\">r8d\u003C/span>, \u003Cspan class=\"hljs-built_in\">r8d\u003C/span>\n                \u003Cspan class=\"hljs-keyword\">movsd\u003C/span>   [\u003Cspan class=\"hljs-built_in\">rsp\u003C/span>+\u003Cspan class=\"hljs-number\">110h\u003C/span>+var_E0], \u003Cspan class=\"hljs-built_in\">xmm0\u003C/span>\n                \u003Cspan class=\"hljs-keyword\">mov\u003C/span>     [\u003Cspan class=\"hljs-built_in\">rsp\u003C/span>+\u003Cspan class=\"hljs-number\">110h\u003C/span>+var_D8], \u003Cspan class=\"hljs-built_in\">eax\u003C/span>\n                \u003Cspan class=\"hljs-keyword\">call\u003C/span>    BehaviourBaseNav_SetPath  \u003Cspan class=\"hljs-comment\">; Send boss claw to finalPatrolPoint\u003C/span>\n                \u003Cspan class=\"hljs-keyword\">jmp\u003C/span>     loc_1804EBB03\n\u003C/code>\u003C/pre>\n\u003Cp>This is the code that maps to what I think the assembly above is doing:\u003C/p>\n\u003Cpre>\u003Ccode class=\"hljs language-cs\">\u003Cspan class=\"hljs-built_in\">float\u003C/span> x = (bossClawAi.patrolXz.x * Random.\u003Cspan class=\"hljs-keyword\">value\u003C/span>) * \u003Cspan class=\"hljs-number\">2\u003C/span> - bossClawAi.patrolXz.x;\n\u003Cspan class=\"hljs-built_in\">float\u003C/span> z = (bossClawAi.patrolXz.z * Random.\u003Cspan class=\"hljs-keyword\">value\u003C/span>) * \u003Cspan class=\"hljs-number\">2\u003C/span> - bossClawAi.patrolXz.z;\nVector3 randCoord = \u003Cspan class=\"hljs-keyword\">new\u003C/span> Vector3(x, \u003Cspan class=\"hljs-number\">0\u003C/span>, z);\nVector3 finalPatrolPoint = randCoord + bossClawAi._homePosition;\nbossClawAi._navAgent.SetDestination(finalPatrolPoint);\n\u003C/code>\u003C/pre>\n\u003Cp>What I found was what I was expecting (a call to get a random value followed by \u003Ccode>NavMeshAgent.SetDestination()\u003C/code>) but not what I was hoping for 😞 (some logic which could be manipulated to force it to go in a certain direction). Although it's important to note that I'm not 100% certain on this. Assembly is complicated. I haven't worked out the purpose of every single instruction and there are so many other code paths in the function. There may be some trick to trigger one of the other \u003Ccode>NavMeshAgent.SetDestination()\u003C/code> calls to send it in the desired direction. 🤷\u003C/p>\n\u003Ch2 id=\"conclusion\">\u003Ca href=\"#conclusion\" role=\"img\" aria-label=\"Link to heading\" onclick=\"event.stopPropagation()\">\u003C/a>📃 Conclusion\u003C/h2>\n\u003Cp>Through this I've learnt a lot about reverse engineering. Sometimes you can get lucky and get C# code to read, other times it's a painful and manual process of reading assembly and cross-referencing against metadata memory addresses. But at this point I feel pretty confident to reverse engineer some aspect of a Unity game and what tools are available. Hope you've learnt a bit about this too from this post! 👍\u003C/p>"],"uses":{"params":["slug"]}}]}
